!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Vue")):"function"==typeof define&&define.amd?define(["Vue"],t):"object"==typeof exports?exports.llescaVue=t(require("Vue")):e.llescaVue=t(e.Vue)}(self,(e=>(()=>{"use strict";var t={407:(e,t)=>{t.Z=(e,t)=>{const i=e.__vccOpts||e;for(const[e,n]of t)i[e]=n;return i}},740:t=>{t.exports=e}},i={};function n(e){var l=i[e];if(void 0!==l)return l.exports;var a=i[e]={exports:{}};return t[e](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{n.d(l,{default:()=>ge});var e={};n.r(e),n.d(e,{createUrl:()=>_,requestBatch:()=>Y,requestDelete:()=>Z,requestGet:()=>z,requestPatch:()=>J,requestPost:()=>H,requestPut:()=>G});var t={};n.r(t),n.d(t,{entityBase:()=>de,entityClear:()=>C,entityClone:()=>R,entityConsolidate:()=>I,entityData:()=>W,entityDefinition:()=>ue,entityDelete:()=>oe,entityLoad:()=>Q,entityParent:()=>re,entityPrimaryValue:()=>se,entitySave:()=>ne,entitySyncData:()=>F,entitySyncState:()=>j,useEntity:()=>N,useEntityCollection:()=>O,useEntityFromId:()=>X});var i={};n.r(i),n.d(i,{useUrl:()=>ce});var a={};n.r(a),n.d(a,{useFetchGet:()=>pe});var o={};n.r(o),n.d(o,{useOptionsLoader:()=>fe});var r={};n.r(r),n.d(r,{useValidations:()=>me});var d={};n.r(d),n.d(d,{clone:()=>ye});var s=n(740);function u(e,t,i){let n;return t?(...l)=>{clearTimeout(n),n=setTimeout((()=>{n=null,e.apply(i,l)}),t)}:e}const c={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},options:{type:Array,required:!0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>(n.multiple&&!e?.length||!n.multiple&&!e)&&"Aquest camp es requerit."),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",n.multiple?[]:null)})),(0,s.watch)((()=>n.options),(e=>{if(n.multiple){const t=n.modelValue.filter((t=>e.some((e=>e.value===t))));t.length!==n.modelValue.length&&i("update:modelValue",t)}else e.some((e=>e.value===n.modelValue))||i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-combo-box");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,options:e.options,readonly:e.readonly,multiple:e.multiple,"allow-freeform":e.allowFreeform,"auto-complete":e.autoComplete,"accent-insensitive":e.accentInsensitive,placeholder:e.placeholder,"immediate-scroll":e.immediateScroll,"max-selected-options":e.maxSelectedOptions,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","invalid","borderless","underlined","options","readonly","multiple","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","error-message","model-value","required","disabled"])}}},p={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:!1},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},getOptions:{type:Function,required:!0},getOptionsWait:{type:Number,default:void 0},filterOptions:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>(n.multiple&&!e?.length||!n.multiple&&!e)&&"Aquest camp es requerit."),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",n.multiple?[]:null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-combo-box-async");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,borderless:e.borderless,underlined:e.underlined,"get-options":e.getOptions,"get-options-wait":e.getOptionsWait,"filter-options":e.filterOptions,readonly:e.readonly,multiple:e.multiple,"auto-complete":e.autoComplete,"accent-insensitive":e.accentInsensitive,placeholder:e.placeholder,"immediate-scroll":e.immediateScroll,"max-selected-options":e.maxSelectedOptions,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","borderless","underlined","get-options","get-options-wait","filter-options","readonly","multiple","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","error-message","model-value","required","disabled"])}}},f={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},stringify:{type:Function,default:e=>{const t=(e,t=2)=>e.toString().padStart(t,"0");return`${t(e.getDate())}/${t(e.getMonth()+1)}/${t(e.getFullYear(),4)}`}},modelValue:{type:Date,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},min:{type:Date,default:null},max:{type:Date,default:null},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>!e&&"Aquest camp es requerit."),null!==n.min&&(e=>e instanceof Date&&e.getTime()<n.min.getTime()&&`El valor mínim es ${n.stringify(n.min)}.`),null!==n.max&&(e=>e instanceof Date&&e.getTime()>n.max.getTime()&&`El valor màxim es ${n.stringify(n.max)}.`),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-date-picker");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,readonly:e.readonly,placeholder:e.placeholder,"not-writable":e.notWritable,days:e.days,months:e.months,"go-today":e.goToday,"first-day-of-the-week":e.firstDayOfTheWeek,today:e.today,parse:e.parse,stringify:e.stringify,"stringify-focus":e.stringifyFocus,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","invalid","borderless","underlined","readonly","placeholder","not-writable","days","months","go-today","first-day-of-the-week","today","parse","stringify","stringify-focus","error-message","model-value","required","disabled"])}}},m={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>(n.multiple&&!e?.length||!n.multiple&&!e)&&"Aquest camp es requerit."),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",n.multiple?[]:null)})),(0,s.watch)((()=>n.options),(e=>{if(n.multiple){const t=n.modelValue.filter((t=>e.some((e=>e.value===t))));t.length!==n.modelValue.length&&i("update:modelValue",t)}else e.some((e=>e.value===n.modelValue))||i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-dropdown");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,options:e.options,placeholder:e.placeholder,readonly:e.readonly,multiple:e.multiple,"immediate-scroll":e.immediateScroll,"max-selected-options":e.maxSelectedOptions,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","invalid","borderless","underlined","options","placeholder","readonly","multiple","immediate-scroll","max-selected-options","error-message","model-value","required","disabled"])}}},y={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:Number,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","click","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>"number"!=typeof e&&"Aquest camp es requerit."),null!==n.min&&(e=>"number"==typeof e&&e<n.min&&`El valor mínim es ${n.min}.`),null!==n.max&&(e=>"number"==typeof e&&e>n.max&&`El valor màxim es ${n.max}.`),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-number-field");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,placeholder:e.placeholder,suffix:e.suffix,multiline:e.multiline,icon:e.icon,readonly:e.readonly,maxlength:e.maxlength,unresizable:e.unresizable,"auto-adjust-height":e.autoAdjustHeight,"format-style":e.formatStyle,"use-grouping":e.useGrouping,"minimum-integer-digits":e.minimumIntegerDigits,"minimum-fraction-digits":e.minimumFractionDigits,"maximum-fraction-digits":e.maximumFractionDigits,"minimum-significant-digits":e.minimumSignificantDigits,"maximum-significant-digits":e.maximumSignificantDigits,parse:e.parse,stringify:e.stringify,"stringify-focus":e.stringifyFocus,align:e.align,"align-focus":e.alignFocus,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onClick:n[0]||(n[0]=e=>i("click",e)),onFocus:n[1]||(n[1]=e=>i("focus",e)),onBlur:f},null,8,["label","invalid","borderless","underlined","placeholder","suffix","multiline","icon","readonly","maxlength","unresizable","auto-adjust-height","format-style","use-grouping","minimum-integer-digits","minimum-fraction-digits","maximum-fraction-digits","minimum-significant-digits","maximum-significant-digits","parse","stringify","stringify-focus","align","align-focus","error-message","model-value","required","disabled"])}}},v={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},step:{type:Number,default:void 0},inc:{type:Function,default:void 0},dec:{type:Function,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:Number,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>"number"!=typeof e&&"Aquest camp es requerit."),null!==n.min&&(e=>"number"==typeof e&&e<n.min&&`El valor mínim es ${n.min}.`),null!==n.max&&(e=>"number"==typeof e&&e>n.max&&`El valor màxim es ${n.max}.`),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-spin-button");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,step:e.step,inc:e.inc,dec:e.dec,parse:e.parse,stringify:e.stringify,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","invalid","borderless","underlined","step","inc","dec","parse","stringify","error-message","model-value","required","disabled"])}}},g={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},getItems:{type:Function,required:!0},getItemsWait:{type:Number,default:void 0},filterItems:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},maxSelectedItems:{type:Number,default:void 0},placeholder:{type:String,default:void 0},loadingText:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:Array,default:()=>[]},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","focus","blur"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>!e?.length&&"Aquest camp es requerit."),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",[])})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-tag-picker");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,readonly:e.readonly,"get-items":e.getItems,"get-items-wait":e.getItemsWait,"filter-items":e.filterItems,"auto-complete":e.autoComplete,"accent-insensitive":e.accentInsensitive,"max-selected-items":e.maxSelectedItems,placeholder:e.placeholder,"loading-text":e.loadingText,"immediate-scroll":e.immediateScroll,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onFocus:n[0]||(n[0]=e=>i("focus",e)),onBlur:f},null,8,["label","description","invalid","borderless","underlined","readonly","get-items","get-items-wait","filter-items","auto-complete","accent-insensitive","max-selected-items","placeholder","loading-text","immediate-scroll","error-message","model-value","required","disabled"])}}},b={props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},createField:{type:Function,default:null},name:{type:[String,Symbol],default:()=>Symbol("fieldText")},modelValue:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:Number,default:null},pattern:{type:RegExp,default:null},rules:{type:Array,default:null},autoValidate:{type:String,default:null,validator:e=>!e||["update","blur"].includes(e)},autoValidateWait:{type:Number,default:0},clearValueOnDisabled:{type:Boolean,default:!1}},emits:["update:modelValue","click","focus","blur","keydown"],setup(e,{expose:t,emit:i}){const n=e,l=(0,s.computed)((()=>[n.required&&(e=>!e&&"Aquest camp es requerit."),null!==n.maxlength&&(e=>e?.length>n.maxlength&&`La longitud màxima es de ${n.maxlength} caracters.`),null!==n.pattern&&(e=>!!e&&!e?.match(n.pattern)&&"El valor del text no compleix el patró especificat."),...n.rules||[]].filter((e=>e)))),{errorMessage:a,validate:o,clear:r,destroy:d}=n.createField?n.createField(n.name,(0,s.toRef)(n,"modelValue"),{rules:l,skip:(0,s.toRef)(n,"disabled")}):{errorMessage:(0,s.ref)(null),validate:()=>!0,clear:()=>{},destroy:()=>{}};t({validate:o,clear:r});const c=(0,s.computed)((()=>u(o,n.autoValidateWait)));function p(e){i("update:modelValue",e),"update"===n.autoValidate&&(0,s.nextTick)((()=>c.value()))}function f(e){i("blur",e),"blur"===n.autoValidate&&o()}return(0,s.watch)((()=>n.disabled),(e=>{e&&n.clearValueOnDisabled&&i("update:modelValue",null)})),(0,s.onBeforeUnmount)(d),(t,n)=>{const l=(0,s.resolveComponent)("fura-text-field");return(0,s.openBlock)(),(0,s.createBlock)(l,{label:e.label,description:e.description,invalid:e.invalid,borderless:e.borderless,underlined:e.underlined,placeholder:e.placeholder,prefix:e.prefix,suffix:e.suffix,multiline:e.multiline,icon:e.icon,readonly:e.readonly,maxlength:e.maxlength,unresizable:e.unresizable,"auto-adjust-height":e.autoAdjustHeight,password:e.password,"error-message":(0,s.unref)(a),"model-value":e.modelValue,required:e.required,disabled:e.disabled,"onUpdate:modelValue":p,onClick:n[0]||(n[0]=e=>i("click",e)),onFocus:n[1]||(n[1]=e=>i("focus",e)),onBlur:f,onKeydown:n[2]||(n[2]=e=>i("keydown",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","maxlength","unresizable","auto-adjust-height","password","error-message","model-value","required","disabled"])}}},h={key:0,class:"stackDraggable-item"},w={class:"stackDraggable-content"},V=["onDragstart"],x={class:"stackDraggable-handler"},S={key:1,class:"stackDraggable-item"},B={class:"stackDraggable-content"},E={props:{name:{type:String,default:()=>String(Math.random()).replace("0.","")},primaryKey:{type:String,required:!0},modelValue:{type:Array,required:!0},handlerPosition:{type:String,default:"center",validate:e=>!e||["top","center","bottom"].includes(e)}},emits:["update:modelValue"],setup(e,{emit:t}){const i=e,n="text/llesca-stack-draggable-key/",l=(0,s.useSlots)(),a=(0,s.ref)([]),o=(0,s.computed)((()=>l.header&&-1!==l.header().findIndex((e=>e.type!==s.Comment)))),r=(0,s.computed)((()=>l.footer&&-1!==l.footer().findIndex((e=>e.type!==s.Comment))));function d(e){e.dataTransfer.types.includes(n+i.name)&&e.preventDefault()}function u(e){const l=e.dataTransfer.getData(n+i.name),o=i.modelValue.findIndex((e=>e[i.primaryKey]===l)),r=a.value.filter((e=>e.el)).reduce(((t,i)=>i.el.getBoundingClientRect().bottom>e.pageY&&i.index<t?i.index:t),a.value.length);var d,s,u;t("update:modelValue",(d=i.modelValue,(s=o)===(u=r)?d:s>u?[...d.slice(0,u),d[s],...d.slice(u,s),...d.slice(s+1)]:[...d.slice(0,s),...d.slice(s+1,u+1),d[s],...d.slice(u+1)]))}return(0,s.onBeforeUpdate)((()=>{a.value=[]})),(t,l)=>{const c=(0,s.resolveComponent)("fura-icon");return(0,s.openBlock)(),(0,s.createElementBlock)("div",{onDragover:d,onDrop:u},[(0,s.unref)(o)?((0,s.openBlock)(),(0,s.createElementBlock)("div",h,[(0,s.createVNode)(c,{class:"stackDraggable-dragIcon"}),(0,s.createElementVNode)("div",w,[(0,s.renderSlot)(t.$slots,"header")])])):(0,s.createCommentVNode)("v-if",!0),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.modelValue,((o,r)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:o[e.primaryKey],ref_for:!0,ref:e=>a.value.push({item:o,index:r,el:e}),draggable:"true",class:"stackDraggable-item",onDragstart:(0,s.withModifiers)((t=>{return l=t,a=o[e.primaryKey],l.dataTransfer.effectAllowed="move",l.dataTransfer.droptAllowed="move",void l.dataTransfer.setData(n+i.name,a);var l,a}),["stop"])},[(0,s.createElementVNode)("div",x,[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["stackDraggable-cover",{"stackDraggable-hide":"top"===e.handlerPosition}]),draggable:"true",onDragstart:l[0]||(l[0]=(0,s.withModifiers)((()=>{}),["stop","prevent"]))},null,34),(0,s.createVNode)(c,{class:"stackDraggable-dragIcon",name:"GripperDotsVertical"}),(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["stackDraggable-cover",{"stackDraggable-hide":"bottom"===e.handlerPosition}]),draggable:"true",onDragstart:l[1]||(l[1]=(0,s.withModifiers)((()=>{}),["stop","prevent"]))},null,34)]),(0,s.createElementVNode)("div",{class:"stackDraggable-content",draggable:"true",onDragstart:l[2]||(l[2]=(0,s.withModifiers)((()=>{}),["stop","prevent"]))},[(0,s.renderSlot)(t.$slots,"default",{item:o,key:r[e.primaryKey],index:r})],32)],40,V)))),128)),(0,s.unref)(r)?((0,s.openBlock)(),(0,s.createElementBlock)("div",S,[(0,s.createVNode)(c,{class:"stackDraggable-dragIcon"}),(0,s.createElementVNode)("div",B,[(0,s.renderSlot)(t.$slots,"footer")])])):(0,s.createCommentVNode)("v-if",!0)],32)}}},k=(0,n(407).Z)(E,[["__scopeId","data-v-3d8db5ed"]]),D=Symbol("internalState");function F(e,t){const i=e?.[D];if(e instanceof N){for(const t in e)e[t]=void 0;if("object"==typeof t)for(const i in t)e[i]=t[i];return!0}if(e instanceof O){const n=i.newEntities.splice(0,i.newEntities.length);for(const e of n)e[D].scope.stop();i.deletedIndices.clear();for(let e=0;e<i.storedEntities.length;e+=1)i.deletedIndices.add(e);if(Array.isArray(t)){const{primaryKey:n}=i.definition,l=Array.from(t);for(let e=0;e<i.storedEntities.length;e+=1){const t=i.storedEntities.value[e],a=t[n],o=l.findIndex((e=>e[n]===a));if(o>-1){const[n]=l.splice(o,1);F(t,n),i.deletedIndices.delete(e)}}for(const t of l)e.add(t)}return!0}return!1}function O(e,{scope:t=(0,s.getCurrentScope)(),root:i,parent:n}={}){const l=new Proxy(t.run((()=>{const a=(0,s.shallowReactive)([]),o=(0,s.shallowReactive)([]),r=(0,s.shallowReactive)(new Set),d=(0,s.computed)((()=>a.filter(((e,t)=>!r.has(t))))),u=(0,s.computed)((()=>d.value.concat(o)));return{scope:t,definition:e,storedEntities:a,newEntities:o,deletedIndices:r,remainingEntities:d,entities:u,root:i??l,parent:n}})),q);return l}const q={get(e,t,i){if("string"==typeof t){if(t in e.entities.value)return e.entities.value[t];if(t in A)return A[t].bind(null,e,i)}return t===D?e:"__v_skip"===t||void 0},set:(e,t,i,n)=>"object"==typeof i&&"length"!==t&&t in e.entities.value&&F(e.entities.value[t],i),has:(e,t)=>Reflect.has(e.entities.value,t),ownKeys:e=>Reflect.ownKeys(e.entities.value),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e.entities.value,t),getPrototypeOf:e=>O.prototype},A={create:(e,t)=>N(e.definition,{scope:e.scope,root:e.root,parent:t}),add(e,t,i){if(i instanceof N&&i[D].root===e.root)return e.newEntities.push(i),i;const n=N(e.definition,{scope:e.scope,root:e.root,parent:t});return F(n,i),e.newEntities.push(n),n},delete(e,t,i){if("length"!==i&&i in e.entities.value){const t=Number(i);if(t<e.remainingEntities.value.length){const i=e.remainingEntities.value[t],n=e.storedEntities.indexOf(i);e.deletedIndices.add(n)}else{const i=t-e.remainingEntities.value.length,[n]=e.newEntities.splice(i,1);n[D].scope.stop()}}},[Symbol.species]:(e,t)=>Array,[Symbol.iterator]:(e,t)=>e.entities.value.value(),at:(e,t,i)=>e.entities.value.at(i),concat:(e,t,...i)=>e.entities.value.concat(...i),copyWithin(){throw new Error("'copyWithin' method is not available.")},entries:(e,t)=>e.entities.value.entries(),every:(e,t,i,n)=>e.entities.value.every(i,n),fill(){throw new Error("'copyWithin' method is not available.")},filter:(e,t,i,n)=>e.entities.value.filter(i,n),find:(e,t,i,n)=>e.entities.value.find(i,n),findIndex:(e,t,i,n)=>e.entities.value.findIndex(i,n),findLast:(e,t,i,n)=>e.entities.value.findLast(i,n),findLastIndex:(e,t,i,n)=>e.entities.value.findLastIndex(i,n),flat(e,t,i=1){throw new Error("'flat' method is not implemented yet.")},flatMap(e,t,i,n){throw new Error("'flatMap' method is not implemented yet.")},forEach:(e,t,i,n)=>e.entities.value.forEach(i,n),includes:(e,t,i,n)=>e.entities.value.includes(i,n),indexOf:(e,t,i,n)=>e.entities.value.indexOf(i,n),join(e,t,i=","){throw new Error("'join' method is not implemented yet.")},keys:(e,t)=>e.entities.value.keys(),lastIndexOf:(e,t,i,n)=>e.entities.value.lastIndexOf(i,n),map:(e,t,i,n)=>e.entities.value.map(i,n),pop(e,t){throw new Error("'pop' method is not implemented yet.")},push(e,t,...i){throw new Error("'push' method is not implemented yet.")},reduce:(e,t,i,n)=>e.entities.value.reduce(i,n),reduceRight:(e,t,i,n)=>e.entities.value.reduceRight(i,n),reverse(){throw new Error("'reverse' method is not available.")},shift(){throw new Error("'shift' method is not available.")},slice:(e,t,i,n)=>e.entities.value.slice(i,n),some:(e,t,i,n)=>e.entities.value.some(i,n),sort(){throw new Error("'sort' method is not available.")},splice(){throw new Error("'splice' method is not available.")},toLocaleString(){throw new Error("'toLocaleString' method is not implemented yet.")},toString(){throw new Error("'toString' method is not implemented yet.")},unshift(){throw new Error("'unshift' method is not implemented yet.")},values:(e,t)=>e.entities.value.values()},P="__v_skip",T="__v_raw";function N(e,{scope:t=(0,s.getCurrentScope)(),root:i,parent:n,base:l}={}){const a=t.run((()=>{const t=(0,s.effectScope)();return t.run((()=>({scope:t,definition:e,storedProperties:(0,s.shallowReactive)({}),changedProperties:(0,s.shallowReactive)({}),properties:null,children:null,details:(0,s.reactive)({}),root:i,parent:n,base:l})))})),o=new Proxy(a,$);return a.properties=Object.fromEntries((e.keys||[]).map((e=>[e,a.scope.run((()=>(0,s.computed)({get:()=>a.changedProperties[e]??a.storedProperties[e],set(t){a.storedProperties[e]===t?delete a.changedProperties[e]:a.changedProperties[e]=t}})))]))),a.children=Object.fromEntries((e.children||[]).map((e=>[e.navigationKey||e.entityName,O(e,{scope:a.scope,root:i??o,parent:o})]))),o[D].root=i??o,o}const $={get(e,t,i){if(t===D)return e;if(t===P)return!0;if(t===T)return!1;if("string"==typeof t){if(t in e.properties)return e.properties[t].value;if(t in e.children)return e.children[t]}return e.details[t]},set(e,t,i,n){if(t===D||t===P||t===T)return!1;if("string"==typeof t){if(t in e.properties)return e.properties[t].value=i,!0;if(t in e.children)return F(e.children[t],i)}return void 0===i?delete e.details[t]:e.details[t]=i,!0},has:(e,t)=>t in e.properties||t in e.children||t in e.details,ownKeys:e=>Object.keys(e.properties).concat(Object.keys(e.children)).concat(Object.keys(e.details)),getOwnPropertyDescriptor(e,t){if(t in e.properties||t in e.children||t in e.details)return{configurable:!0,enumerable:!0}},getPrototypeOf:e=>N.prototype};function j(e,t){const i=e?.[D],n=t?.[D];if(e instanceof N&&t instanceof N&&i.definition===n.definition){for(const e in i.storedProperties)e in n.storedProperties||delete i.storedProperties[e];for(const e in n.storedProperties)i.storedProperties[e]=n.storedProperties[e];for(const e in i.changedProperties)e in n.changedProperties||delete i.changedProperties[e];for(const e in n.changedProperties)i.changedProperties[e]=n.changedProperties[e];for(const e in n.details)i.details[e]=n.details[e];for(const e in n.children)j(i.children[e],n.children[e]);return!0}if(e instanceof O&&t instanceof O&&i.definition===n.definition){const i=e[D],n=t[D];i.storedEntities.splice(0,i.storedEntities.length).forEach((e=>e[D].scope.stop()));for(const t of n.storedEntities){const n=e.create();j(n,t),i.storedEntities.push(n)}i.newEntities.splice(0,i.newEntities.length).forEach((e=>e[D].scope.stop()));for(const t of n.newEntities){const n=e.create();j(n,t),i.newEntities.push(n)}i.deletedIndices.clear();for(const e of n.deletedIndices.values())i.deletedIndices.add(e);return!0}return!1}function C(e){const t=e?.[D];if(e instanceof N){for(const e in t.storedProperties)delete t.storedProperties[e];for(const e in t.changedProperties)delete t.changedProperties[e];for(const e in t.children)C(t.children[e]);for(const e in t.details)delete t.details[e];return!0}return e instanceof O&&(t.storedEntities.splice(0,t.storedEntities.length).forEach((e=>e[D].scope.stop())),t.newEntities.splice(0,t.newEntities.length).forEach((e=>e[D].scope.stop())),t.deletedIndices.clear(),!0)}function I(e){const t=e?.[D];if(e instanceof N){const e=Object.keys(t.changedProperties);for(const i of e)t.storedProperties[i]=t.changedProperties[i],delete t.changedProperties[i];for(const e in t.children)I(t.children[e]);return!0}if(e instanceof O){const e=Array.from(t.deletedIndices).sort().reverse();for(const i of e){const[e]=t.storedEntities.splice(i,1);e[D].scope.stop()}t.deletedIndices.clear();const i=t.newEntities.splice(0,t.newEntities.length);t.storedEntities.push(...i);for(const e of t.storedEntities)I(e);return!0}return!1}function R(e,{scope:t}={}){if(!(e instanceof N))throw new Error;const i=N(e[D].definition,{scope:t,base:e});return j(i,e),i}function W(e,{depth:t,withoutDetails:i=!1,withoutChildren:n=!1}={},l=0){const a=e?.[D];if(e instanceof N){const e=[];for(const t in a.properties)a.properties[t]&&e.push([t,a.properties[t].value]);if(!i)for(const t in a.details){const i=a.details[t];null!=i&&e.push([t,JSON.parse(JSON.stringify(i))])}if(!n&&("number"!=typeof t||l<t))for(const o in a.children)e.push([o,W(a.children[o],{depth:t,withoutDetails:i,withoutChildren:n},l+1)]);return Object.fromEntries(e)}if(e instanceof O)return a.entities.value.map((e=>W(e,{depth:t,withoutDetails:i,withoutChildren:n},l)))}class M extends Error{constructor(e,t){super(`Bad HTTP response status ${e.statusText}'`),this.name="HttpError",this.status=e.status,this.statusText=e.statusText,this.body=t}}class K extends Error{constructor(e,t){super(`Bad HTTP response status '${e.statusText||e.status}'`),this.name="HttpError",this.status=e.status,this.statusText=e.statusText,this.responses=t}}function U(e={},{withContent:t=!1,withAccept:i=!1}={}){return Object.assign({},t?{"Content-Type":"application/json"}:{},i?{Accept:"application/json"}:{},e)}async function L(e){const t=e.headers.has("content-type")&&e.headers.get("content-type").includes("application/json")?await e.json():await e.text();if(e.ok)return t;throw new M(e,t)}function _(e,t={}){const i=e.reduce(((e,t)=>{if(null==t)return e;if(null==e)return t;const i=e.endsWith("/"),n=t.startsWith("/");return i&&n?e+t.substr(1):i||n?e+t:e+"/"+t}),null),n=new URL(i);for(const e in t)null!=t[e]&&n.searchParams.append(e,t[e]);return n}async function z(e,t,i){const n=_(e,t),l={headers:{...U(i,{withAccept:!0}),...i}},a=await fetch(n,l);return await L(a)}async function H(e,t,i,n){const l=_(e,i),a={method:"POST",headers:{...U(n,{withContent:!0,withAccept:!0}),...n},body:JSON.stringify(t)},o=await fetch(l,a);return await L(o)}async function G(e,t,i,n){const l=_(e,i),a={method:"PUT",headers:{...U(n,{withContent:!0,withAccept:!0}),...n},body:JSON.stringify(t)},o=await fetch(l,a);return await L(o)}async function J(e,t,i,n){const l=_(e,i),a={method:"PATCH",headers:{...U(n,{withContent:!0,withAccept:!0}),...n},body:JSON.stringify(t)},o=await fetch(l,a);return await L(o)}async function Z(e,t,i){const n=_(e,t),l={method:"DELETE",headers:{...U(i,{withAccept:!0}),...i}},a=await fetch(n,l);return await L(a)}async function Y(e,t,i){const n=e+(e.endsWith("/")?"$batch":"/$batch"),l=await fetch(n,{method:"POST",headers:U(null,{withContent:!0,withAccept:!0}),body:JSON.stringify({requests:t.map((e=>({...e,headers:{...U(i,{withContent:!0,withAccept:!0}),...e.headers||{}}})))})}),{responses:a}=await L(l),o=a.find((e=>!(e.status>=200&&e.status<300)));if(o)throw new K(o,a);return a}async function Q(e,t,i,n){const l=await async function(e,t,i,n){const l=await z([t,`${e.entityName}(${n})`],{$select:ee(e),$expand:te(e)},i);return delete l["@odata.context"],ie(e,l),l}(e[D].definition,t,i,n);C(e),F(e,l),I(e)}function X(e,t,i,n){const l=(0,s.ref)(!1),a=N(e);return Q(a).then((()=>{l.value=!0})),{entity:a,loaded:l}}function ee(e){if(Array.isArray(e.keys)&&e.keys.length>0)return Array.isArray(e.ignoredKeys)&&e.ignoredKeys.length>0?e.keys.filter((t=>!e.ignoredKeys.includes(t))).join():void 0}function te(e){const t=[],i=[...e.children||[],...e.details||[]];for(const e of i){const i=e.navigationKey||e.entityName,n=[],l=ee(e);l&&n.push(`$select=${l}`),(e.children?.length>0||e.details?.length>0)&&n.push(`$expand=${te(e)}`),n.length>0?t.push(`${i}(${n.join(";")})`):t.push(i)}return t.length>0?t.join():void 0}function ie(e,t){if(Array.isArray(e.dateKeys))for(const i of e.dateKeys)"string"==typeof t[i]&&(t[i]=new Date(t[i]));if(e.children)for(const i of e.children){const e=i.navigationKey||i.entityName;if(Array.isArray(t[e]))for(const n of t[e])ie(i,n);else"object"==typeof t[e]&&ie(i,t[e])}}async function ne(e,t,i){if(e instanceof N){const n=le(e);if(n.length>0){!function(e,t){for(const i of t)if(i.body){const[,t]=i.id.match(/^(.*)\/(?:create|update|delete)$/);F(ae(e,t),i.body)}}(e,await Y(t,n,i)),I(e);const l=e[D];if(l.parent){const t=l.parent[D],i=t.newEntities.indexOf(e);i>-1&&(t.newEntities.splice(i,1),t.storedEntities.push(e))}l.base&&j(l.base,e)}return!0}return!1}function le(e,t=""){const i=e[D],{entityName:n,primaryKey:l,foreingKey:a}=i.definition;if(e instanceof N){const o=e[l];if(null==o){const l=W(e,{withoutDetails:!0});if(a&&i.parent){const e=i.parent[D].parent[D];l[a]=e.properties[e.definition.primaryKey].value}return[{atomicityGroup:"entitySave",id:`${t}/create`,method:"POST",url:n,body:l}]}{const e=[];Object.keys(i.changedProperties).length>0&&e.push({atomicityGroup:"entitySave",id:`${t}/update`,method:"PATCH",url:`${n}(${o})`,body:{...i.changedProperties}});for(const n in i.children)e.push(...le(i.children[n],`${t}/${n}`));return e}}if(e instanceof O){const e=[];for(const a of i.deletedIndices){const o=i.storedEntities[a][l];e.push({atomicityGroup:"entitySave",id:`${t}(${o})/delete`,method:"DELETE",url:`${n}(${o})`})}for(let n=0;n<i.entities.value.length;n+=1)e.push(...le(i.entities.value[n],`${t}[${n}]`));return e}return[]}function ae(e,t){if(!t)return e;const[i,n,l]=t.match(/^\/([^[]+)\[(\d+)]/);return ae(e[n][l],t.substring(i.length))}async function oe(e,t,i){if(e instanceof N){const n=e[D];if(n.scope.stop(),n.base)return oe(n.base,t,i);const{entityName:l,primaryKey:a}=n.definition,o=e[a];if(null!=o){if(await Z([t,null,`${l}(${o})`],i),n.parent){const t=n.parent[D],i=t.storedEntities.indexOf(e);if(i>-1){t.storedEntities.splice(i,1),t.deletedIndices.delete(i);const e=Array.from(t.deletedIndices).filter((e=>e>i)).sort();for(const i of e)t.deletedIndices.delete(i),t.deletedIndices.add(i-1)}const l=t.newEntities.indexOf(e);l>-1&&t.newEntities.splice(l,1)}return!0}}return!1}function re(e,{includeCollections:t=!1}={}){let i=e?.[D]?.parent;if(!t)for(;i instanceof O;)i=i?.[D]?.parent;return i}function de(e){return e?.[D]?.base}function se(e){if(e instanceof N)return e[e[D].definition.primaryKey]}function ue(e){if(e instanceof N||e instanceof O)return e[D].definition}function ce(e,t){return{url:(0,s.computed)((()=>{const i=(0,s.unref)(e),n=Array.isArray(i)?i.reduce(((e,t)=>{const i=(0,s.unref)(e),n=(0,s.unref)(t);if(null==n)return i;const l=i.endsWith("/"),a=n.startsWith("/");return l&&a?i+n.substr(1):l||a?i+n:i+"/"+n})):i,l=new URL(n),a=(0,s.unref)(t);for(const e in a)null!=(0,s.unref)(a[e])&&l.searchParams.append(e,a[e]);return l}))}}function pe(e,t,i,n){const l=(0,s.shallowRef)(null),a=(0,s.shallowRef)(!1),o=(0,s.shallowRef)(null),r=[];function d(e){for(const t of r)t(e)}const{url:u}=ce(e,t),c=(0,s.computed)((()=>{const e={Accept:"application/json"},t=(0,s.unref)(i);for(const i in t)e[i]=(0,s.unref)(t[i]);return e}));async function p(){l.value=null,o.value=null,a.value=!0;let e=null;try{e=await fetch(u.value,{headers:c.value});const t=e.headers.has("content-type")&&e.headers.get("content-type").includes("application/json")?await e.json():await e.text();l.value=e.status,e.ok?o.value=t:d({type:"badResponse",status:e.status,statusText:e.statusText,body:t})}catch(e){d({type:"exception",name:e.name,message:e.message})}a.value=!1}return(0,s.watch)([u,c],(()=>!(0,s.unref)((0,s.unref)(n)?.manual)&&p()),{immediate:!0}),{status:l,isLoading:a,data:o,load:p,onError:function(e){r.push(e)}}}function fe(e,t,i,n,l,a){const o=(0,s.unref)(i),r=(0,s.unref)(n),d=(0,s.unref)(l),u=(0,s.computed)((()=>{const e={};e.$orderby=r;for(const t in d)e[t]=(0,s.unref)(d[t]);return e.$select=`${o},${r}`,e})),{status:c,isLoading:p,data:f,error:m,load:y}=pe([e,t],u,a);return{status:c,isLoading:p,options:(0,s.computed)((()=>(f.value?.value||[]).map((e=>({value:e[o],text:e[r]}))))),error:m,load:y}}function me(){const e=(0,s.reactive)(new Map),t=(0,s.reactive)(new Map),i=[],n=(0,s.computed)((()=>Object.fromEntries(Array.from(e.entries()).map((([e,{value:t}])=>[e,(0,s.unref)(t)])))));return{fields:(0,s.computed)((()=>Array.from(e.keys()))),validations:(0,s.computed)((()=>Array.from(t.keys()))),values:n,createField:function(t,l,{rules:a,skip:o}={}){const r=(0,s.ref)(null);async function d(...e){r.value=null;const t=(0,s.unref)(a);if(t&&!(0,s.unref)(o))for(const i of t){const t=i((0,s.unref)(l),(0,s.unref)(n),...e),a=t instanceof Promise?await t:t;if(a&&"string"==typeof a)return r.value=a,!1}return!0}function u(){r.value=null}return e.set(t,{value:l,validate:d,clean:u}),(0,s.watch)(l,((e,n)=>{r.value=null,function(e){for(const t of i)t(e)}({name:t,value:e,oldValue:n})})),{errorMessage:(0,s.isRef)(o)?(0,s.computed)((()=>o.value?null:(0,s.unref)(r))):r,destroy:function(){e.delete(t)},validate:d,clean:u}},createValidation:function(e,{rules:i,skip:l}={}){const a=(0,s.ref)(null);async function o(...e){a.value=null;const t=(0,s.unref)(i);if(t&&!(0,s.unref)(l))for(const i of t){const t=i((0,s.unref)(n),...e),l=t instanceof Promise?await t:t;if(l&&"string"==typeof l)return a.value=l,!1}return!0}function r(){a.value=null}return t.set(e,{validate:o,clean:r}),{errorMessage:(0,s.isRef)(l)?(0,s.computed)((()=>l.value?null:(0,s.unref)(a))):a,destroy:function(){t.delete(e)},validate:o,clean:r}},validate:async function(...i){let n=!0;for(const{validate:t}of e.values())n=await t(...i)&&n;for(const{validate:e}of t.values())n=await e(...i)&&n;return n},clean:function(){for(const{clean:t}of e.values())t();for(const{clean:e}of t.values())e()},onChange:function(e){i.push(e)}}}function ye(e){return e instanceof Date?new Date(e.getTime()):Array.isArray(e)?e.map((e=>ye(e))):e&&"object"==typeof e?Object.setPrototypeOf(Object.fromEntries(function(e){return Object.entries(e).concat(Object.getOwnPropertySymbols(e).map((t=>[t,e[t]])))}(e).map((([e,t])=>[e,ye(t)]))),Object.getPrototypeOf(e)):e}const ve={FieldCombo:c,FieldComboAsync:p,FieldDate:f,FieldDropdown:m,FieldNumber:y,FieldNumberSpin:v,FieldTag:g,FieldText:b,StackDraggable:k},ge={install:function(e,{prefix:t="llesca"}={}){for(const t in ve){const i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();e.component("llesca-"+i,ve[t])}},Llesca:ve,version:"0.4.3",...t,...a,...o,...i,...r,odata:e,object:d}})(),l.default})()));